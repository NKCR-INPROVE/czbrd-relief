package cz.incad.czbrd.bf;

import com.amaio.plaant.businessFunctions.*;
import com.amaio.plaant.sync.Record;
import cz.incad.czbrd.EvidenceMereniEntity;
import cz.incad.czbrd.EvidenceMereniPrilohaEntity;
import cz.incad.czbrd.ExemplarEntity;
import cz.incad.czbrd.PrilohaEntity;
import cz.incad.relief3.core.BussinesFunction_A;
import java.math.BigDecimal;
import java.util.Date;

/** ****************************************************************************
 * Bussines funkce generující tiskový výstup v HTML
 * @author martin.novacek@incad.cz
 */
public class ExemplarTiskovyVystupOne extends BussinesFunction_A {
    private Record local_recKeeper;
    private RecordsIterator local_recRit;    
    private Record local_recEvidence; 
    private Record local_recPriloha;
    private Record local_recMerPriloha;
    private String local_tEvidenceMereni = "tEvidenceMereni";    
    private Boolean local_prilohaCheck = true;

    /** ************************************************************************
     * 
     * @return
     * @throws ValidationException
     * @throws WizardException 
     */
    public WizardMessage startWizard() throws ValidationException, WizardException {
        
        WizardMessage wm = new WizardMessage(); 
        local_recRit = getWCC().getSelectedRecords();
        local_recKeeper = local_recRit.nextRecord();
        
        String poskozeniPrilohy_bilogockePoskozeni  = "";
        String poskozeniPrilohy_mechanickePoskozeni = "";
        String poskozeniPrilohy_chemickePoskozeni   = "";
        String merStrana                            = "";
        String typPrilohy                           = "";
        String typPapiru                            = "";
        String typTisku                             = "";
        String barvaTisku                           = "";
        String nazevPrilohy                         = "";        
        String merKde                               = "";
        String s_merPH                              = "";        
        String barevnostL                           = "";
        String barevnostA                           = "";
        String barevnostE                           = "";
        String barevnostB                           = "";
        String s_hmotnost                           = "";
        String s_merNote                            = "";
        String s_merPoznamka                        = "";
        String s_p_Poznamka                         = "";
        String s_PPapPoznamka                       = "";
        String s_mechPosPoznamka                    = "";
        String celkovePoskozeni                     = "";
        String s_prilohaCount                       = "";
        String s_kBlokPH                            = "";
        String s_obalkaPH                           = "";
        String s_obalPH                             = "";
        String s_obalkaZpusob                         = "";
        String s_kBlokZpusob                          = ""; 
        String s_merZpusob                            = "";
        String s_posDesky                           = "";
        String s_posHrbetnik                        = "";
        String s_posKapitalek                       = "";
        String s_posZalStuzka                       = "";
        String s_posPredsadka                       = "";
        String s_posVazba                           = "";
        String s_posObalka                          = "";        
        String se_typTisku                          = "";
        String se_zbarveniPapiru                    = ""; 
        String se_typPapiru                         = "";
        String neuplnostExemplare                   = "";
        String material                             = "";
        String ochrannyObal                         = "";
        String druhVazby                            = "";
        String typVazby                             = "";
        String typFondu                             = "";
        String s_se_pismo                           = "";
        
        
        
        if(getWCC().getSelectedRecords().getRecordsCount() == 1){            
            RecordsIterator HistorieMereni = local_recKeeper.getTableField(local_tEvidenceMereni).getTableRecords();
            RecordsIterator ritPriloha = local_recKeeper.getTableField(ExemplarEntity.F_tPriloha_TAB).getTableRecords();            
            local_recEvidence = local_recKeeper.getCompositeField(EvidenceMereniEntity.F_cEvidenceMereni_STR).getCompositeRecord();

            int prilohaCount = ritPriloha.getRecordsCount();
            
            try{
                BigDecimal kBlokPH = (BigDecimal) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_kBlokPH_STR).getValue();
                s_kBlokPH = kBlokPH.toString();
            }catch(NullPointerException e){} 
            
            try{
                BigDecimal obalkaPH = (BigDecimal) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_obalkaPH_STR).getValue();
                s_obalkaPH = obalkaPH.toString();
            }catch(NullPointerException e){}
            
            try{
                BigDecimal obalPH = (BigDecimal) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_obalPH_STR).getValue();
                s_obalPH = obalPH.toString();
            }catch(NullPointerException e){}
            
            try{
                String obalkaZpusob = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_obalkaZpusob_STR).getValue();
                if(obalkaZpusob == null){ obalkaZpusob = "";}
                s_obalkaZpusob = nullPointer_check(obalkaZpusob); 
            }catch(NullPointerException e){}
            
            try{
                String kBlokZpusob = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_kBlokZpusob_STR).getValue();
                if(kBlokZpusob == null){ kBlokZpusob = "";}
                s_kBlokZpusob = nullPointer_check(kBlokZpusob);
            }catch(NullPointerException e){}
            
            try{
                String merZpusob = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_merZpusob_STR).getValue();
                if(merZpusob == null){ merZpusob = "";}
                s_merZpusob = nullPointer_check(merZpusob);
            }catch(NullPointerException e){}  

            
            try{
                String posDesky = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posDesky_STR).getValue();
                s_posDesky = Character.toString(posDesky.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posHrbetnik = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posHrbetnik_STR).getValue();
                s_posHrbetnik = Character.toString(posHrbetnik.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posKapitalek = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posKapitalek_STR).getValue();
                s_posKapitalek = Character.toString(posKapitalek.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posZalStuzka = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posZalStuzka_STR).getValue();
                s_posZalStuzka = Character.toString(posZalStuzka.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posPredsadka = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posPredsadka_STR).getValue();
                s_posPredsadka = Character.toString(posPredsadka.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posVazba = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posVazba_STR).getValue();
                s_posVazba = Character.toString(posVazba.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                String posObalka = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_posObalka_STR).getValue();
                s_posObalka = nullPointer_check(posObalka);
            }catch(NullPointerException e){}
            
            try{
                typFondu = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzTypFondu_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                typVazby = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzTypVazby_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                druhVazby = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzDruhVazby_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                ochrannyObal = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzOchrannyObal_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                material = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzMaterial_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                neuplnostExemplare = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzNeupExem_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                se_typPapiru = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzTypPapiru_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                se_zbarveniPapiru = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzZabarveniPapiru_STR).getValue();
            }catch(NullPointerException e){}
            
            try{
                String se_pismo = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzPismo_STR).getValue();
                s_se_pismo = Character.toString(se_pismo.charAt(2));
            }catch(NullPointerException e){}
            
            try{
                se_typTisku = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_fyzTypTisku_STR).getValue();
            }catch(NullPointerException e){}
            
            if(prilohaCount == 0){
                s_prilohaCount = "0 příloh";
            }else{
                s_prilohaCount = "1. ze "+prilohaCount+"";
            }
            
            //test, jestli ma zaznam prilohu
            try{
                local_recPriloha = ritPriloha.nextRecord();                
            }catch(IndexOutOfBoundsException | NullPointerException ex) {
                local_prilohaCheck = false;
            }

            //zacatek prilohy
            if(local_prilohaCheck){
                local_recMerPriloha = local_recPriloha.getCompositeField(PrilohaEntity.F_cEvidenceMereniPriloha_COM).getCompositeRecord();
                typPrilohy = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_typPrilohy_STR).getValue();
                typPapiru = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_typPapiru_STR).getValue();
                typTisku = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_typTisku_STR).getValue();
                barvaTisku = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_barvaTisku_STR).getValue();
                
                nazevPrilohy = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_nazevPrilohy_STR).getValue(); 
                poskozeniPrilohy_bilogockePoskozeni = getPoskozeniList(local_recMerPriloha, new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pBioHlodavci_STR,"hlo."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pBioHmyz_STR,"hm."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pBioPlisBak_STR,"pl./bak."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pBioNeni_STR,"Není"));
                poskozeniPrilohy_mechanickePoskozeni = getPoskozeniList(local_recMerPriloha, new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechChybCast_STR,"ch.část"), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechCinHlodHmyz_STR,"hlo./hm."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechKrehkost_STR,"křeh."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechLepPas_STR,"lep.pás."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pMechPrehPrek_STR,"přeh./překl."));
                poskozeniPrilohy_chemickePoskozeni = getPoskozeniList(local_recMerPriloha, new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemJinTek_STR,"j. tek."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemMast_STR,"mast."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemPrach_STR,"prach"), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemBarSkv_STR,"bar.skvr."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemTepPos_STR,"tep.poš."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemVoda_STR,"voda"), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemZdeg_STR,"zdeg."), new OnePoskozeni(EvidenceMereniPrilohaEntity.f_pChemNecTex_STR,"nečit.text"));
                
                merStrana = (String) local_recPriloha.getSimpleField(PrilohaEntity.F_strana_STR).getValue();
                merKde = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_merKde_STR).getValue();
                BigDecimal merPH = (BigDecimal) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_merPH_STR).getValue();
                s_merPH = merPH.toString();
                

                barevnostL = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_barevnostL_STR).getValue();
                barevnostA = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_barevnostA_STR).getValue();
                barevnostE = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_barevnostE_STR).getValue();
                barevnostB = (String) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_barevnostB_STR).getValue();
                BigDecimal hmotnost = (BigDecimal) local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_hmotnost_STR).getValue();
                s_hmotnost = hmotnost.toString();
            
                
                if(local_recMerPriloha.getSimpleField(EvidenceMereniPrilohaEntity.f_note_STR).getValue() == null){
                    s_merNote = "Ne";
                }else{
                    s_merNote = "Ano";
                }
            }
            //konec prilohy
            
            
            if(local_recEvidence.getSimpleField(EvidenceMereniEntity.F_mechPosPoznamka_STR).getValue() == null){
                s_mechPosPoznamka = "Ne";
            }else{
                s_mechPosPoznamka = "Ano";
            }
            if(local_recEvidence.getSimpleField(EvidenceMereniEntity.F_pPapPoznamka_STR).getValue() == null){
                s_PPapPoznamka = "Ne";
            }else{
                s_PPapPoznamka = "Ano";
            }
            if(local_recEvidence.getSimpleField(EvidenceMereniEntity.F_pPoznamka_STR).getValue() == null){
                s_p_Poznamka = "Ne";
            }else{
                s_p_Poznamka = "Ano";
            }
            if(local_recEvidence.getSimpleField(EvidenceMereniEntity.F_merPoznamky_STR).getValue() == null){
                s_merPoznamka = "Ne";
            }else{
                s_merPoznamka = "Ano";
            }           
            
            
            String poskozeniDokumentu_bilogockePoskozeni    = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pBioHlodavci_STR,"hlo."), new OnePoskozeni(EvidenceMereniEntity.F_pBioHmyz_STR,"hm."), new OnePoskozeni(EvidenceMereniEntity.F_pBioNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pBioPlisBak_STR,"pl./bak."), new OnePoskozeni(EvidenceMereniEntity.F_pBioZvirExk_STR,"exkr."));
            String poskozeniDokumentu_mechanickePoskozeni   = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pMechChybCast_STR,"ch.část"), new OnePoskozeni(EvidenceMereniEntity.F_pMechCinHlodHmyz_STR,"hlo./hm."), new OnePoskozeni(EvidenceMereniEntity.F_pMechKreh_STR,"křeh."), new OnePoskozeni(EvidenceMereniEntity.F_pMechNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pMechPrehPrek_STR,"přeh./překl."), new OnePoskozeni(EvidenceMereniEntity.F_pMechSlepList_STR,"slep.l."), new OnePoskozeni(EvidenceMereniEntity.F_pMechLepPas_STR,"lep.pás."));
            String poskozeniDokumentu_chemickePoskozeni     = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pChemJinTek_STR,"j. tek."), new OnePoskozeni(EvidenceMereniEntity.F_pChemMast_STR,"mast."), new OnePoskozeni(EvidenceMereniEntity.F_pChemNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pChemPrach_STR,"prach"), new OnePoskozeni(EvidenceMereniEntity.F_pChemBarSkvr_STR,"bar.skvr."), new OnePoskozeni(EvidenceMereniEntity.F_pChemTepPos_STR,"tep.poš."), new OnePoskozeni(EvidenceMereniEntity.F_pChemVoda_STR,"voda"));
            String poskozeniPapiru_chemickePoskozeni        = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pPapChemJinTek_STR,"j. tek."), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemMast_STR,"mast."), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemNecTex_STR,"nečit.text"), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemPrach_STR,"prach"), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemBarSkv_STR,"bar.skvr."), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemTepPos_STR,"tep.poš."), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemVoda_STR,"voda"), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemZdeg_STR,"zdeg."), new OnePoskozeni(EvidenceMereniEntity.F_pPapChemNeni_STR,"Není"));
            String poskozeniPapiru_mechanickePoskozeni      = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pPapMechChybCast_STR,"ch.část"), new OnePoskozeni(EvidenceMereniEntity.F_pMechCinHlodHmyz_STR,"hlo./hm."), new OnePoskozeni(EvidenceMereniEntity.F_pMechKreh_STR,"křeh."), new OnePoskozeni(EvidenceMereniEntity.F_pMechPrehPrek_STR,"přeh./překl."), new OnePoskozeni(EvidenceMereniEntity.F_pMechSlepList_STR,"slep.l."), new OnePoskozeni(EvidenceMereniEntity.F_pPapMechNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pPapMechChybCelStr_STR,"ch.str."));
            String poskozeniPapiru_bilogockePoskozeni       = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pPapBioHlodavci_STR,"hlo."), new OnePoskozeni(EvidenceMereniEntity.F_pPapBioHmyz_STR,"hm."), new OnePoskozeni(EvidenceMereniEntity.F_pPapBioPlisBak_STR,"pl./bak."), new OnePoskozeni(EvidenceMereniEntity.F_pPapBioNeni_STR,"Není"));
            String poskozeniObalky_bilogockePoskozeni       = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pObaBioHlodavci_STR,"hlo."), new OnePoskozeni(EvidenceMereniEntity.F_pObaBioHmyz_STR,"hm."), new OnePoskozeni(EvidenceMereniEntity.F_pObaBioPlisBak_STR,"pl./bak."), new OnePoskozeni(EvidenceMereniEntity.F_pObaBioNeni_STR,"Není"));
            String poskozeniObalky_mechanickePoskozeni      = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pObaMechChybCast_STR,"ch.část"), new OnePoskozeni(EvidenceMereniEntity.F_pObaMechCinHlodHmyz_STR,"hlo./hm."), new OnePoskozeni(EvidenceMereniEntity.F_pObaMechKrehkost_STR,"křeh."), new OnePoskozeni(EvidenceMereniEntity.F_pObaMechNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pObaMechLepPas_STR,"lep.pás."));
            String poskozeniObalky_chemickePoskozeni        = getPoskozeniList(local_recEvidence, new OnePoskozeni(EvidenceMereniEntity.F_pObaChemJinTek_STR,"j. tek."), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemMast_STR,"mast."), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemNeni_STR,"Není"), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemPrach_STR,"prach"), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemBarSkv_STR,"bar.skvr."), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemTepPos_STR,"tep.poš."), new OnePoskozeni(EvidenceMereniEntity.F_pObaChemVoda_STR,"tep.poš."));            
            
            String carKod           = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_bibCarKod_STR).getValue();
            String signatura        = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_bibSignatura_STR).getValue();
            String nazev            = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_bibNazev_STR).getValue();
            String autor            = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_bibAutor_STR).getValue();
            String rokVydani        = (String) local_recKeeper.getSimpleField(ExemplarEntity.F_bibRokVydani_STR).getValue();
            String ChybStrana_Val   = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_pPapMechChybCelStrVal_STR).getValue();            
            String kBlokKde         = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_kBlokKde_STR).getValue();            
            String kBlokStrana      = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_kBlokStrana_STR).getValue();
            String obalkaKde        = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_obalkaKde_STR).getValue();
            String recID            = (String) local_recKeeper.getSimpleField(EvidenceMereniEntity.F_ex_recID_STR).getValue();
            String editoval         = (String) local_recKeeper.getSimpleField(EvidenceMereniEntity.F_ex_recEdiUser_STR).getValue();
            String druhZasahu       = (String) local_recEvidence.getSimpleField(EvidenceMereniEntity.F_druhZasahu_STR).getValue();
            
            Date editDate           = (Date) local_recKeeper.getSimpleField(EvidenceMereniEntity.F_ex_recEdiDate_STR).getValue();
            String s_editDate = editDate.toString();
            
            if ("nadeskach".equals(s_posObalka)) {
                s_posObalka = "\"Na deskách\"";
            } else if ("vevazana".equals(s_posObalka)) {
                s_posObalka = "Vevázaná";
            } else if ("neni".equals(s_posObalka)) {
                s_posObalka = "Není";
            } else if (s_posObalka == null) {
                s_posObalka = "";
            }


            if ("tuzka".equals(s_merZpusob)) {
                s_merZpusob = "Tužka";
            } else if ("elektroda".equals(s_merZpusob)) {
                s_merZpusob = "Elektroda";
            } else if (s_merZpusob == null) {
                s_merZpusob = "";
            }
            

            if ("tuzka".equals(s_kBlokZpusob)) {
                s_kBlokZpusob = "Tužka";
            } else if("elektroda".equals(s_kBlokZpusob)) {
                s_kBlokZpusob = "Elektroda";
            } else if(s_kBlokZpusob == null) {
                s_kBlokZpusob = "";
            }
            

            if ("tuzka".equals(s_obalkaZpusob)) {
                s_obalkaZpusob = "Tužka";
            } else if ("elektroda".equals(s_obalkaZpusob)) {
                s_obalkaZpusob = "Elektroda";
            } else if (s_obalkaZpusob == null) {
                s_obalkaZpusob = "";
            }

            if(poskozeniDokumentu_bilogockePoskozeni.contains("Není") && poskozeniDokumentu_chemickePoskozeni.contains("Není") && poskozeniDokumentu_mechanickePoskozeni.contains("Není") && poskozeniPapiru_chemickePoskozeni.contains("Není") && poskozeniPapiru_bilogockePoskozeni.contains("Není") && poskozeniPapiru_mechanickePoskozeni.contains("Není") && poskozeniObalky_bilogockePoskozeni.contains("Není") && poskozeniObalky_chemickePoskozeni.contains("Není") && poskozeniObalky_mechanickePoskozeni.contains("Není") && poskozeniPrilohy_bilogockePoskozeni.contains("Není") && poskozeniPrilohy_chemickePoskozeni.contains("Není") && poskozeniPrilohy_mechanickePoskozeni.contains("Není")){
                celkovePoskozeni = "Ne";
            }else{
                celkovePoskozeni = "Ano";
            }
            
            if(HistorieMereni.getRecordsCount() > 0){
            wm.setHtml(true);
            wm.addLine("<html>"
                        + "<head>"

                            + "<title>Formulář - průzkum novodobých fondů</title>"
                            + "<SCRIPT LANGUAGE=\"JavaScript\">"

                                +"myRef = window.open('','mywin','left=20,top=20,width=500,height=500,toolbar=1,resizable=1');"
                                
                    
                                + "myRef.document.write('"
                                    + "<tr><br><td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=center > <label for=\"DruhZasahu\"><b>Druh zásahu</b></label> </th> <td class=\"col1\" align=center> <label for=\"prilohaZaznamu\" ><b>Příloha záznamu</b></label> </td></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=center> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(druhZasahu)+"\" readonly> </th> <td class=\"col1\" align=center> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(nazevPrilohy)+"\" readonly> </td></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" colspan=4 align=left><b><u><i><span style=\"color: green;\">Mechanické poškození dokumentu</span></i></u></b></th> <th width=10></th> <th class=\"col0\" align=left colspan=2><b><u><i><span style=\"color: green;\">Poškození knižního bloku</span></i></u></b> <th width=10></th> <th class=\"col0\" size=60 colspan=4 align=left><b><u><i><span style=\"color: green;\">Poškození obálky</span></i></u></b></th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Desky: </b></th> <th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posDesky)+"\" readonly></th>  <th class=\"col0\" align=left> <b>Kapitálek: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posKapitalek)+"\" readonly> </th> <th width=10></th><th class=\"col0\" align=left> <b>Předsádka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posPredsadka)+"\" readonly> </th> <th width=10></th> <th class=\"col0\" align=left> <b>Obálka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posObalka)+"\" readonly> </th><th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_mechanickePoskozeni+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Hřbetník: </b></th> <th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posHrbetnik)+"\" readonly></th>  <th class=\"col0\" align=left> <b>Zál. stužka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posZalStuzka)+"\" readonly> </th> <th width=10></th><th class=\"col0\" align=left> <b>Vazba: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posVazba)+"\" readonly> </th> <th width=10></th> <th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+s_mechPosPoznamka+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_bilogockePoskozeni+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th width=10></th> <th class=\"col0\" align=left></th><th class=\"col0\" align=left> </th> <th width=10></th> <th class=\"col0\" align=left> </th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_chemickePoskozeni+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left size=60 colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: green;\">Poškození papíru</span></i></u></b></label> </th> <th class=\"col0\"align=left size=60 colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: green;\">Poškození dokumentu</span><i></u></b></label> </th> <th class=\"col0\"align=left colspan = 2> <label for=\"FondType\"><b><u><i><span style=\"color: #663300;\">Měření obálka</span></i></u></b></label> </th> <th class=\"col0\" colspan=4 align=left> <label for=\"FondType\"><b><u><i><span style=\"color: #663300;\">Měření knižní blok</span></i></u></b></label> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Mechanické: </b> </th> <th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_mechanickePoskozeni+"\" readonly> </th> <th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\"  align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_mechanickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\"size=10 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(s_obalkaZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color:  #C0C0C0;\" value=\""+nullPointer_check(s_kBlokZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=5 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+kBlokStrana+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Biologické: </b></th> <th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\"  align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(obalkaKde)+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(kBlokKde)+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=5 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_kBlokPH+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_chemickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\"  align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_chemickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_obalkaPH+"\" readonly> </th></tr> "
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60v STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+s_PPapPoznamka+"\" readonly> </th><th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+s_p_Poznamka+"\" readonly> </th><th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=10 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_merPoznamka+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Chybějící strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+nullPointer_check(ChybStrana_Val)+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Přílohy - ("+s_prilohaCount+")</span></i></u></b></label> </th> <th class=\"col0\" size=60 align=left colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Poškození</span></i></u></b></label> </th> <th class=\"col0\" colspan=4 align=left> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Měření příloha</span><i></u></b></label> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Typ přílohy: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typPrilohy))+"\" readonly> </th><th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_mechanickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(s_merZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=5 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+merStrana+"\" readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Typ papíru: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typPapiru))+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(merKde)+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=5 STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_merPH+"\"  readonly> </th></tr>"                        
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Typ tisku: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typTisku))+"\" readonly> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_chemickePoskozeni+"\" readonly> </th></tr> "
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Barva tisku: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7e STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(barvaTisku))+"\" readonly> </th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=7 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+s_merNote+"\" readonly> </th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> <b>Barevnost CIELAB </b></th><th class=\"col0\" align=right size=1> <b> L </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostL+"\" size=5 readonly> </th><th class=\"col0\" align=left size=5> <b> a </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostA+"\" size=5 readonly> </th><th class=\"col0\" align=left size=5> <b> b </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostB+"\" size=5 readonly> </th> <th class=\"col0\" align=left size=5> <b> E* </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostE+"\" size=5 readonly> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> <b>Hmotnost: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_hmotnost+"\" size=5 readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left colspan=3> <label for=\"FondType\"><b><u><i><span style=\"color: #FF9900;\">Identifikace záznamu</span></i></u></b></label> </th> <th class=\"col0\" align=left colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: #FF9900;\">Přiložené soubory</span></i></u></b></label> </th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <b>Jméno: </b></th><th class=\"col0\" align=left> <b>Datum: </b></th><th class=\"col0\" align=left> <b>ID záznamu: </b></th></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(editoval)+"\" readonly> </th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(s_editDate) +"\" readonly> </th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(recID)+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"
                    + "');"
                    
                    //vytiskne stranku
                    + "myRef.print();"
                    + "window.close('5000')"

                            + "</SCRIPT>"

                        + "</head>"
                        + "<body>"


                            

                        + "</body>"
                    + "</html>");
            }else{
                wm.setHtml(true);
                wm.addLine("<html>"           
                            + "<head>"
                        
                                + "<title>Formulář - Následný průzkum po změnách</title>"
                                + "<SCRIPT LANGUAGE=\"JavaScript\">"
                                +"myRef = window.open('','mywin','left=20,top=20,width=500,height=500,toolbar=1,resizable=1');"
                                
                    
                                + "myRef.document.write('"                        
                                    + "<tr><br><td> <td><table class=\"inline\" >"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <label><b>Čárový kód</b></label> </th> <td class=\"col1\" align=left> <label><b>Příloha záznamu</b></label></td> <td class=\"col1\" align=left> <label><b>Signatura</b></label></td> <td class=\"col1\" align=left> <label><b>Název</b></label></td> <td class=\"col1\" align=left> <label><b>Autor</b></label></td> <td class=\"col1\" align=left> <label><b>Rok vydání</b></label></td></tr>"
                                    + "<tr class=\"row0\">"
                                        + "<th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(carKod)+"\" readonly> </th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(signatura)+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(nazev)+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(autor)+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(rokVydani)+"\" readonly></td></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><td> <td><table class=\"inline\">"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <label><b>Průzkum</b></label> </th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" readonly> </th> <td class=\"col1\" align=left> <label><b>Údaje o zpracování</b></label></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" readonly> </th> <td class=\"col1\" align=left> <label><b>Poškození</b></label></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+celkovePoskozeni+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td> <td><table class=\"inline\" >"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <label><b>Typ fondu</b></label> </th> <td class=\"col1\" align=left> <label><b>Typ vazby</b></label></td> <td class=\"col1\" align=left> <label><b>Druh vazby</b></label></td> <td class=\"col1\" align=left> <label><b>Ochranný obal</b></label></td> <td class=\"col1\" align=left> <label><b>Materiál</b></label></td> <td class=\"col1\" align=left> <label><b>pH materiálu</b></label></td> <td class=\"col1\" align=left> <label><b>Neúplnost exempláře</b></label></td></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(typFondu)))+"\" readonly> </th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(typVazby)))+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(druhVazby)))+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(ochrannyObal)))+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(material)))+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_obalPH+"\" readonly></td> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #FF9999;\" value=\""+nullPointer_check(neuplnostExemplare)+"\" readonly></td></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td> <td><table class=\"inline\" >"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left colspan=4> <label><b><u><i><span style=\"color: #9933FF;\">Stav exempláře</span></i></u></b></label> </th> <th class=\"col0\" colspan=4 align=left><b><u><i><span style=\"color: green;\">Mechanické poškození dokumentu</span></i></u></b></span></th> <th class=\"col0\" align=left colspan=2><b><u><i><span style=\"color: green;\">Poškození knižního bloku</span></i></u></b></th> <th class=\"col0\" colspan=4 align=left size=60><b><u><i><span style=\"color: green;\">Poškození obálky</span></i></u></b></th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <label><b>Typ papíru</b></label></th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #9999FF;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(se_typPapiru))) +"\" readonly></td> <th class=\"col0\" align=left><label><b>Zbarvení papíru</b></label></th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #9999FF;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(se_zbarveniPapiru)))+"\" readonly></td> <th class=\"col0\" align=left> <b>Desky: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posDesky)+"\" readonly> </th><th class=\"col0\" align=left> <b>Kapitálek: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posKapitalek)+"\" readonly> </th><th class=\"col0\" align=left> <b>Předsádka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posPredsadka)+"\" readonly> </th><th class=\"col0\" align=left> <b>Obálka: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posObalka)+"\" readonly> </th><th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_mechanickePoskozeni+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left><label><b>Písmo</b></label></th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #9999FF;\" value=\""+nullPointer_check(s_se_pismo)+"\" readonly></td> <th class=\"col0\" align=left><label><b>Typ tisku</b></label></th> <td class=\"col1\" align=left><input type=\"text\" STYLE=\"color: #000000; background-color: #9999FF;\" value=\""+nullPointer_check(exclamation_check(getHumanName_Vanilla(se_typTisku)))+"\" readonly></td> <th class=\"col0\" align=left> <b>Hřbetník: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posHrbetnik)+"\" readonly> </th><th class=\"col0\" align=left> <b>Zál. stužka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posZalStuzka)+"\" readonly> </th><th class=\"col0\" align=left> <b>Vazba: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=1 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+nullPointer_check(s_posVazba)+"\" readonly> </th><th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+s_mechPosPoznamka+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_bilogockePoskozeni+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #99FF99;\" value=\""+poskozeniObalky_chemickePoskozeni+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><td><table class=\"inline\" >"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left colspan=2 size=60> <label><b><u><i><span style=\"color: green;\">Poškození papíru</span></i></u></b></label> </th> <th class=\"col0\"align=left colspan=2 size=60> <label><b><u><i><span style=\"color: green;\">Poškození dokumentu</span><i></u></b></label> </th> <th class=\"col0\"align=left colspan = 2> <label for=\"FondType\"><b><u><i><span style=\"color: green;\">Měření obálka</span></i></u></b></label> </th> <th class=\"col0\" colspan=4 align=left> <label for=\"FondType\"><b><u><i><span style=\"color: green;\">Měření knižní blok</span></i></u></b></label> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Mechanické: </b> </th> <th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_mechanickePoskozeni+"\" readonly> </th> <th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_mechanickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(s_obalkaZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(s_kBlokZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(kBlokStrana)+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Biologické: </b></th> <th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(obalkaKde)+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+nullPointer_check(kBlokKde)+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_kBlokPH+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniPapiru_chemickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+poskozeniDokumentu_chemickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_obalkaPH+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+s_PPapPoznamka+"\" readonly> </th><th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+s_p_Poznamka+"\" readonly> </th><th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_merPoznamka+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Chybějící strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #66FF33;\" value=\""+nullPointer_check(ChybStrana_Val)+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\">"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Přílohy - ("+s_prilohaCount+")</span></i></u></b></label> </th> <th class=\"col0\" align=left colspan=2 size=60> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Poškození</span></i></u></b></label> </th> <th class=\"col0\" colspan=4 align=left> <label for=\"FondType\"><b><u><i><span style=\"color: #3300FF;\">Měření obálka</span><i></u></b></label> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Typ přílohy: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typPrilohy))+"\" readonly> </th><th class=\"col0\" align=left> <b>Mechanické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_mechanickePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Způsob: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" size=5 value=\""+nullPointer_check(s_merZpusob)+"\" readonly> </th><th class=\"col0\" align=left> <b>Strana: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+merStrana+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Typ papíru: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typPapiru))+"\" readonly> </th><th class=\"col0\" align=left> <b>Biologické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_bilogockePoskozeni+"\" readonly> </th><th class=\"col0\" align=left> <b>Kde: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" size=5 value=\""+merKde+"\" readonly> </th><th class=\"col0\" align=left> <b>pH: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+s_merPH+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Typ tisku: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(typTisku))+"\" readonly> </th><th class=\"col0\" align=left> <b>Chemické: </b></th><th class=\"col0\" align=left> <input type=\"text\" size=60 STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+poskozeniPrilohy_chemickePoskozeni+"\" readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Barva tisku: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+exclamation_check(getHumanName_Priloha(barvaTisku))+"\" readonly> </th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left></th> <th class=\"col0\" align=left> <b>Poznámka: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #33CCFF;\" value=\""+s_merNote+"\" size=5 readonly> </th><th class=\"col0\" align=left></th><th class=\"col0\" align=left size=17> <b>Barevnnost CIELAB </b></th><th align=\"center\"> <b> L </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostL+"\" size=5 readonly> </th><th class=\"col0\" align=left size=5> <b> a </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostA+"\" size=5 readonly> </th><th class=\"col0\" align=left size=5> <b> b </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" size=5 value=\""+barevnostB+"\" readonly> </th> <th class=\"col0\" align=left size=5> <b> E* </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" value=\""+barevnostE+"\" size=5 readonly> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left></th><th class=\"col0\" align=left> <b>Hmotnost: </b></th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #C0C0C0;\" size=5 value=\""+s_hmotnost+"\" readonly> </th></tr>"
                                    + "</td></tr></table>"

                                    + "<tr><br><td><table class=\"inline\">"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left colspan=3> <label for=\"FondType\"><b><u><i><span style=\"color: #FF9900;\">Identifikace záznamu</span></i></u></b></label> </th> <th class=\"col0\" align=left colspan=2> <label for=\"FondType\"><b><u><i><span style=\"color: #FF9900;\">Přiložené soubory</span></i></u></b></label> </th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <b>Jméno: </b></th><th class=\"col0\" align=left> <b>Datum: </b></th><th class=\"col0\" align=left> <b>ID záznamu: </b></th></tr>"
                                        + "<tr class=\"row0\">"
                                            + "<th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(editoval)+"\" readonly> </th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(s_editDate)+"\" readonly> </th><th class=\"col0\" align=left> <input type=\"text\" STYLE=\"color: #000000; background-color: #FF9900;\" value=\""+nullPointer_check(recID)+"\" readonly> </th></tr>"
                                    + "</td></tr></table><br>"
                                + "');"
                            + "myRef.print();"
                            + "window.close('5000')"

                                + "</SCRIPT>"
                        
                            + "</head>"
                       
                            + "<body>"
                               
                       
                            + "</body>"                 
                       + "</html>"); 
               //+ ""
            }
        }else{
           wm.addLine("Musí být zvole pouze a jen jeden záznam"); 
        }
        return wm;
    }

    /** ************************************************************************
     * 
     * @param panelName
     * @return
     * @throws ValidationException
     * @throws WizardException 
     */
    public WizardMessage panelLeave(String panelName) throws ValidationException, WizardException {
        WizardMessage wm = new WizardMessage();        
        wm.addLine("Mas tady chybu");
        return wm;
    }

    /** ************************************************************************
     * 
     * @return
     * @throws ValidationException
     * @throws WizardException
     * @throws ApplicationErrorException 
     */
    public WizardMessage runBusinessMethod() throws ValidationException, WizardException, ApplicationErrorException {
        WizardMessage wm = new WizardMessage();        
        wm.addLine("");
        return wm;
    }
    
    private String getPoskozeniList(Record recEvidenceMereni, OnePoskozeni... poskozeni) {
        StringBuilder sb  = new StringBuilder();
        for (int i = 0; i < poskozeni.length; i++) {
            //if ((boolean)(recEvidenceMereni.getSimpleField(poskozeni[i].field).getValue())) {
            if ((Boolean)recEvidenceMereni.getSimpleField(poskozeni[i].field).getValue()) {
                if (sb.length() > 1) sb.append(", ");
                sb.append(poskozeni[i].value);
            }
        } 
        return sb.toString();
    }
    
    
    private String exclamation_check(String value){
        if(value.equals("!!")){
            value = "";
        }
        return value;
    }
    
    private String nullPointer_check(String value){
        try{
            if(value == null){
                value = "";
            }
        }catch(NullPointerException e){value = "";}
        return value;
    }
    
    
    private String getHumanName_Priloha(String value) {
        String exit = "";
        
        try{    
            if (value.equals("cd"))               exit = "SLPrilohaTypPrilohy.cd";
            if (value.equals("gramofonovadeska")) exit = "SLPrilohaTypPrilohy.gramofonovadeska";
            if (value.equals("disketa"))          exit = "SLPrilohaTypPrilohy.disketa";
            if (value.equals("mapa"))             exit = "SLPrilohaTypPrilohy.mapa";
            if (value.equals("strih"))            exit = "SLPrilohaTypPrilohy.strih";
            if (value.equals("rys"))              exit = "SLPrilohaTypPrilohy.rys";
            if (value.equals("zzzJiny"))          exit = "SLPrilohaTypPrilohy.jiny";

            if (value.equals("stejnyjakokb"))     exit = "SLPrilohaTypPapiru.stejnyjakokb";
            if (value.equals("kridovy"))          exit = "SLPrilohaTypPapiru.kridovy";
            if (value.equals("rucni"))            exit = "SLPrilohaTypPapiru.rucni";
            if (value.equals("drevity"))          exit = "SLPrilohaTypPapiru.drevity";
            if (value.equals("zzzjiny"))          exit = "SLPrilohaTypPapiru.jiny";

            if (value.equals("grafika"))          exit = "SLPrilohaTypTisku.grafika";
            if (value.equals("hlubotisk"))        exit = "SLPrilohaTypTisku.hlubotisk";
            if (value.equals("plochytisk"))       exit = "SLPrilohaTypTisku.plochytisk";
            if (value.equals("strih"))            exit = "SLPrilohaTypTisku.strih";
            if (value.equals("mapa"))             exit = "SLPrilohaTypTisku.mapa";
            if (value.equals("rys"))              exit = "SLPrilohaTypTisku.rys";
            if (value.equals("zzzJiny"))          exit = "SLPrilohaTypTisku.jiny";

            if (value.equals("cerna"))            exit = "SLPrilohaBarvaTisku.cerna";
            if (value.equals("jednobarevna"))     exit = "SLPrilohaBarvaTisku.jednobarevna";
            if (value.equals("zzzjina"))          exit = "SLPrilohaBarvaTisku.jina";
        }catch(NullPointerException e){}
        
        return getWCC().getLocalizedString(exit);
        
    }
    
    private String getHumanName_Vanilla(String value) {
        String exit = "";
        try{
            if (value.equals("svetly"))           exit = "SLZabarveniPapiru.svetly";
            if (value.equals("tmavy"))            exit = "SLZabarveniPapiru.tmavy";
            if (value.equals("barevny"))          exit = "SLZabarveniPapiru.barevny";
            if (value.equals("jiny"))             exit = "SLZabarveniPapiru.jiny";

            if (value.equals("stejnyjakokb"))     exit = "SLTypPapiru.stejnyjakokb";
            if (value.equals("kridovy"))          exit = "SLTypPapiru.kridovy";
            if (value.equals("rucni"))            exit = "SLTypPapiru.rucni";
            if (value.equals("drevity"))          exit = "SLTypPapiru.drevity";
            if (value.equals("zzzjiny"))          exit = "SLTypPapiru.jiny";
            if (value.equals("novinovy"))         exit = "SLTypPapiru.novinovy";

            if (value.equals("grafika"))          exit = "SLTypTisku.grafika";
            if (value.equals("hlubotisk"))        exit = "SLTypTisku.hlubotisk";
            if (value.equals("plochytisk"))       exit = "SLTypTisku.plochytisk";
            if (value.equals("strih"))            exit = "SLTypTisku.strih";
            if (value.equals("mapa"))             exit = "SLTypTisku.mapa";
            if (value.equals("rys"))              exit = "SLTypTisku.rys";
            if (value.equals("zzzJiny"))          exit = "SLTypTisku.jiny";

            if (value.equals("hudebniny"))        exit = "Monografie";
            if (value.equals("periodikum"))       exit = "Periodikum";
            if (value.equals("monografie"))       exit = "Hudebniny";

            if (value.equals("pevna"))            exit = "SLTypVazby.pevna";
            if (value.equals("polotuha"))         exit = "SLTypVazby.polotuha";
            if (value.equals("brozovana"))        exit = "SLTypVazby.brozovana";
            if (value.equals("brozura"))          exit = "SLTypVazby.brozura";
            if (value.equals("deskyskapsou"))     exit = "SLTypVazby.deskyskapsou";

            if (value.equals("celopapirova"))     exit = "SLDruhVazby.celopapirova";
            if (value.equals("celoplatena"))      exit = "SLDruhVazby.celoplatena";
            if (value.equals("celokozena"))       exit = "SLDruhVazby.celokozena";
            if (value.equals("poloplatena"))      exit = "SLDruhVazby.poloplatena";
            if (value.equals("polokozena"))       exit = "SLDruhVazby.polokozena";
            if (value.equals("satenova"))         exit = "SLDruhVazby.satenova";
            if (value.equals("zzzjiny"))          exit = "SLDruhVazby.jiny";

            if (value.equals("krabice"))          exit = "SLOchrannyObal.krabice";
            if (value.equals("desky"))            exit = "SLOchrannyObal.desky";
            if (value.equals("neni"))             exit = "SLOchrannyObal.neni";
            if (value.equals("tubus"))            exit = "SLOchrannyObal.tubus";
            if (value.equals("obalka"))           exit = "SLOchrannyObal.obalka";

            if (value.equals("archivnilepenka"))  exit = "SLMaterial.archivnilepenka";
            if (value.equals("puvodni"))          exit = "SLMaterial.puvodni";
            if (value.equals("nevhodne"))         exit = "SLMaterial.nevhodne";
        }catch(NullPointerException e){}
//        if (value.equals(""))          exit = "";
        
        return getWCC().getLocalizedString(exit);
    }
}
    




class OnePoskozeni{
    public String field;
    public String value;
    
    public OnePoskozeni(String field, String value) {
        this.field = field;
        this.value = value;
    }
}

