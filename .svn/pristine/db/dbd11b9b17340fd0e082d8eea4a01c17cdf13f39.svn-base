/* *****************************************************************************
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package cz.incad.czbrd.common;

import com.amaio.plaant.DbBrowser;
import com.amaio.plaant.metadata.Column;
import cz.incad.relief3.core.tools.Commons;
import cz.incad.relief3.core.tools.ReliefLogger;
import java.rmi.RemoteException;

/** ****************************************************************************
 *
 * @author martin.novacek@incad.cz
 */
public class DBB {
    public static DbBrowser dbb = Commons.getDbBrowser();

    /** ************************************************************************
     * 
     */
    public static void reSetDBB() {
        DBB.dbb = Commons.getDbBrowser();
    }

    /** ************************************************************************
     * 
     * @return
     * @throws RemoteException 
     */
    public static Column createColumn(String classname, String field) {
        Column column = new Column();
        classname = Commons.getClassNameWithoutEntity(classname);
        
        try {
            column.setColumnName(field);
            column.setDbField(dbb.findObject(classname).getMember(field));
            return column;
        } catch(RemoteException ex1) {
            ReliefLogger.throwing(null, null, ex1);
            try {
                column.setColumnName(field);
                reSetDBB();
                column.setDbField(dbb.findObject(classname).getMember(field));
                return column;
            } catch(RemoteException ex2) {
                ReliefLogger.throwing(null, null, ex2);
                return null;
            }
        }
    }

}
